{% extends 'base.html' %}

{% block content %}
<div class="container" style="text-align: center;">
    <h1>Battery Dashboard</h1>

    <div class="battery-status" style="margin: 50px auto; max-width: 400px; position: relative;">
        <!-- Toggle Switch -->
        <div class="toggle-container" style="margin-bottom: 20px;">
            <label class="switch" style="position: relative; display: inline-block; width: 60px; height: 34px;">
                <input type="checkbox" id="charging-toggle" checked style="opacity: 0; width: 0; height: 0;">
                <span class="slider round"
                    style="position: absolute; cursor: pointer; top: 0; left: 0; right: 0; bottom: 0; background-color: #ccc; transition: .4s; border-radius: 34px;">
                </span>
                <style>
                    .slider:before {
                        position: absolute;
                        content: "";
                        height: 26px;
                        width: 26px;
                        left: 4px;
                        bottom: 4px;
                        background-color: white;
                        transition: .4s;
                        border-radius: 50%;
                    }

                    input:checked+.slider {
                        background-color: #2196F3;
                    }

                    input:focus+.slider {
                        box-shadow: 0 0 1px #2196F3;
                    }

                    input:checked+.slider:before {
                        transform: translateX(26px);
                    }
                </style>
            </label>
            <p style="margin-top: 5px; color: #aaa;">Toggle Charging</p>
        </div>

        <!-- CSS Battery Animation -->
        <div class="battery-shell"
            style="border: 4px solid #fff; border-radius: 15px; padding: 10px; height: 150px; width: 300px; margin: 0 auto; position: relative;">
            <div id="battery-level"
                style="background: linear-gradient(90deg, #ff0055, #4facfe); height: 100%; width: 50%; border-radius: 10px; transition: width 0.5s;">
            </div>
            <div
                style="position: absolute; right: -20px; top: 50px; width: 10px; height: 50px; background: #fff; border-radius: 0 5px 5px 0;">
            </div>
        </div>
        <h2 id="percentage-text" style="font-size: 3rem; margin-top: 20px;">50%</h2>
        <p id="status-text" style="color: #00f2fe;">Charging - Multiple Sources Active</p>
    </div>

    <div class="active-sources" style="display: flex; justify-content: center; gap: 20px; margin-top: 30px;">
        <span class="badge"
            style="padding: 5px 15px; background: rgba(255,235,59,0.2); color: #ffeb3b; border-radius: 15px; border: 1px solid #ffeb3b;">Solar:
            120mA</span>
        <span class="badge"
            style="padding: 5px 15px; background: rgba(0,229,255,0.2); color: #00e5ff; border-radius: 15px; border: 1px solid #00e5ff;">Acoustic:
            45mA</span>
        <span class="badge"
            style="padding: 5px 15px; background: rgba(255,0,85,0.2); color: #ff0055; border-radius: 15px; border: 1px solid #ff0055;">Piezo:
            80mA</span>
    </div>

</div>

<!-- IoT Connectivity Status -->
<div class="card" style="margin-top: 20px;">
    <h3><i class="fas fa-wifi" style="color: var(--primary-color);"></i> IoT Connectivity</h3>
    <div style="display: flex; justify-content: space-between; align-items: center; margin-top: 15px;">
        <div style="text-align: left;">
            <p style="margin: 5px 0; color: #ccc;">Status: <span style="color: #28a745; font-weight: bold;">‚óè
                    Online</span></p>
            <p style="margin: 5px 0; color: #ccc;">Device: <span style="color: white;">ESP32-S3 Module</span></p>
        </div>
        <div style="text-align: right;">
            <p style="margin: 5px 0; color: #ccc;">Cloud Sync: <span style="color: #00e5ff;">Active</span></p>
            <p style="margin: 5px 0; color: #aaa; font-size: 0.9rem;">Last update: <span id="last-sync">Just now</span>
            </p>
        </div>
    </div>
</div>
</div>

<script>
    // Simulate real-time sync updates
    const syncText = document.getElementById('last-sync');
    let seconds = 0;
    setInterval(() => {
        seconds++;
        if (seconds < 5) syncText.textContent = 'Just now';
        else if (seconds < 10) syncText.textContent = seconds + 's ago';
        else {
            seconds = 0;
            syncText.textContent = 'Syncing...';
            setTimeout(() => syncText.textContent = 'Just now', 1000);
        }
    }, 1000);
</script>
</div>
{% endblock %}